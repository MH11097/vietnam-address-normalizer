<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BIDV Address Parser</title>

    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- Bootstrap Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.2/font/bootstrap-icons.min.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
    <!-- Header -->
    <header class="bg-primary text-white py-4 mb-4">
        <div class="container">
            <h1 class="display-5 mb-2">
                <i class="bi bi-geo-alt-fill"></i>
                BIDV Address Parser
            </h1>
            <p class="lead mb-0">B√≥c t√°ch v√† d·ª± ƒëo√°n ƒë·ªãa ch·ªâ kh√°ch h√†ng v·ªõi AI</p>
        </div>
    </header>

    <!-- Main Content -->
    <div class="container-fluid">
        <div class="row">
            <!-- Left Column: Input Form -->
            <div class="col-lg-4">

                <!-- Tabs -->
                <ul class="nav nav-tabs mb-4" role="tablist">
                    <li class="nav-item" role="presentation">
                        <button class="nav-link active" id="manual-tab" data-bs-toggle="tab" data-bs-target="#manual" type="button" role="tab">
                            <i class="bi bi-pencil-square"></i> Nh·∫≠p th·ªß c√¥ng
                        </button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="random-tab" data-bs-toggle="tab" data-bs-target="#random" type="button" role="tab">
                            <i class="bi bi-shuffle"></i> Random t·ª´ Database
                        </button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="review-tab" data-bs-toggle="tab" data-bs-target="#review" type="button" role="tab">
                            <i class="bi bi-clipboard-check"></i> Review
                        </button>
                    </li>
                </ul>

                <!-- Tab Content -->
                <div class="tab-content">

                    <!-- Manual Input Tab -->
                    <div class="tab-pane fade show active" id="manual" role="tabpanel">
                        <div class="card shadow-sm">
                            <div class="card-body position-relative">
                                <!-- Random Mode Badge (hidden by default) -->
                                <div id="randomModeBadge" class="random-mode-badge" style="display: none;">
                                    <i class="bi bi-shuffle"></i> Random Mode
                                </div>

                                <form id="parseForm">

                                    <!-- Address Input -->
                                    <div class="mb-3">
                                        <label for="address" class="form-label">ƒê·ªãa ch·ªâ <span class="text-danger">*</span></label>
                                        <textarea
                                            class="form-control"
                                            id="address"
                                            rows="3"
                                            placeholder="V√≠ d·ª•: NGO394 DOI CAN P.CONG VI BD HN"
                                            required
                                        ></textarea>
                                    </div>

                                    <!-- Province Dropdown -->
                                    <div class="mb-3">
                                        <label for="province" class="form-label">T·ªânh/Th√†nh ph·ªë (tu·ª≥ ch·ªçn)</label>
                                        <select class="form-select" id="province">
                                            <option value="">-- Ch·ªçn t·ªânh/th√†nh ph·ªë --</option>
                                        </select>
                                        <small class="text-muted">Ch·ªçn t·ªânh gi√∫p tƒÉng ƒë·ªô ch√≠nh x√°c</small>
                                    </div>

                                    <!-- District Dropdown -->
                                    <div class="mb-3">
                                        <label for="district" class="form-label">Qu·∫≠n/Huy·ªán (tu·ª≥ ch·ªçn)</label>
                                        <select class="form-select" id="district">
                                            <option value="">-- Ch·ªçn qu·∫≠n/huy·ªán --</option>
                                        </select>
                                        <small class="text-muted">Ch·ªçn qu·∫≠n/huy·ªán gi√∫p tƒÉng ƒë·ªô ch√≠nh x√°c</small>
                                    </div>

                                    <!-- Known Values Display (Hidden by default, shown in Random mode) -->
                                    <div id="knownValuesSection" class="mb-3" style="display: none;">
                                        <div class="card bg-light border-dashed">
                                            <div class="card-body py-2">
                                                <small class="text-muted d-block mb-2">
                                                    <i class="bi bi-database"></i> <strong>Known Values t·ª´ Database:</strong>
                                                </small>
                                                <div class="row g-2">
                                                    <div class="col-6">
                                                        <span id="knownProvince" class="text-primary fw-bold">____</span>
                                                    </div>
                                                    <div class="col-6">
                                                        <span id="knownDistrict" class="text-success fw-bold">____</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Submit Button -->
                                    <button type="submit" class="btn btn-primary btn-lg w-100" id="parseBtn">
                                        <i class="bi bi-cpu"></i>
                                        <span id="parseBtnText">Parse Address</span>
                                    </button>
                                </form>
                            </div>
                        </div>
                    </div>

                    <!-- Random Sample Tab -->
                    <div class="tab-pane fade" id="random" role="tabpanel">
                        <div class="card shadow-sm">
                            <div class="card-body">
                                <div class="text-center mb-4">
                                    <i class="bi bi-database-fill text-primary" style="font-size: 3rem;"></i>
                                    <h5 class="mt-2">Load ƒë·ªãa ch·ªâ ng·∫´u nhi√™n t·ª´ Database</h5>
                                </div>

                                <!-- Random Filter Form -->
                                <form id="randomFilterForm">
                                    <!-- Province Filter -->
                                    <div class="mb-3">
                                        <label for="randomProvince" class="form-label">L·ªçc theo T·ªânh/Th√†nh ph·ªë</label>
                                        <select class="form-select" id="randomProvince">
                                            <option value="">-- T·∫•t c·∫£ t·ªânh/th√†nh ph·ªë --</option>
                                        </select>
                                    </div>

                                    <!-- District Filter -->
                                    <div class="mb-3">
                                        <label for="randomDistrict" class="form-label">L·ªçc theo Qu·∫≠n/Huy·ªán</label>
                                        <select class="form-select" id="randomDistrict">
                                            <option value="">-- T·∫•t c·∫£ qu·∫≠n/huy·ªán --</option>
                                        </select>
                                    </div>

                                    <!-- Load Random Button -->
                                    <button type="button" class="btn btn-primary btn-lg w-100" id="loadRandomBtn">
                                        <i class="bi bi-shuffle"></i> <span id="loadRandomBtnText">Load Random Sample</span>
                                    </button>
                                </form>
                            </div>
                        </div>
                    </div>

                    <!-- Review Tab -->
                    <div class="tab-pane fade" id="review" role="tabpanel">
                        <div class="card shadow-sm">
                            <div class="card-body">
                                <div class="text-center mb-4">
                                    <i class="bi bi-clipboard-check-fill text-success" style="font-size: 3rem;"></i>
                                    <h5 class="mt-2">Review Records</h5>
                                    <p class="text-muted small mb-0">Review v√† c·∫≠p nh·∫≠t rating cho c√°c records ƒë√£ x·ª≠ l√Ω</p>
                                </div>

                                <!-- Review Filter Form -->
                                <form id="reviewFilterForm">
                                    <!-- Rating Filter -->
                                    <div class="mb-3">
                                        <label for="reviewRatingFilter" class="form-label">
                                            <i class="bi bi-funnel"></i> L·ªçc theo Rating
                                        </label>
                                        <select class="form-select" id="reviewRatingFilter">
                                            <option value="all">T·∫•t c·∫£ (0+1+2+3)</option>
                                            <option value="0">‚ö™ Ch∆∞a review (0)</option>
                                            <option value="1">üü¢ T·ªët (1)</option>
                                            <option value="2">üü° Trung b√¨nh (2)</option>
                                            <option value="3">üî¥ K√©m (3)</option>
                                        </select>
                                    </div>

                                    <!-- Load Button -->
                                    <button type="button" class="btn btn-success btn-lg w-100" id="loadReviewBtn">
                                        <i class="bi bi-search"></i> <span id="loadReviewBtnText">Load Records</span>
                                    </button>
                                </form>
                            </div>
                        </div>
                    </div>

                </div>

            </div>

            <!-- Middle Column: Result Display / Review Records -->
            <div class="col-lg-6">
                <!-- Parsing Result Section (shown for Manual/Random tabs) -->
                <div id="resultSection" class="sticky-top" style="top: 20px;">
                    <!-- Result content will be dynamically inserted here -->
                    <div class="card shadow-sm text-center py-5">
                        <div class="card-body">
                            <i class="bi bi-arrow-left text-muted" style="font-size: 3rem;"></i>
                            <h5 class="mt-3 text-muted">K·∫øt qu·∫£ s·∫Ω hi·ªÉn th·ªã ·ªü ƒë√¢y</h5>
                            <p class="text-muted mb-0">Nh·∫≠p ƒë·ªãa ch·ªâ v√† click "Parse Address" ƒë·ªÉ b·∫Øt ƒë·∫ßu</p>
                        </div>
                    </div>
                </div>

                <!-- Review Records Section (shown for Review tab) -->
                <div id="reviewRecordsSection" style="display: none;">
                    <div class="card shadow-sm">
                        <div class="card-header bg-success text-white">
                            <h6 class="mb-0">
                                <i class="bi bi-list-check"></i> Review Records
                                <span id="reviewRecordCount" class="badge bg-light text-dark float-end">0</span>
                            </h6>
                        </div>
                        <div class="card-body p-0">
                            <!-- Records list container -->
                            <div id="reviewRecordsList" style="max-height: 70vh; overflow-y: auto;">
                                <!-- Records will be loaded here dynamically -->
                                <div class="text-center py-5 text-muted">
                                    <i class="bi bi-arrow-left" style="font-size: 3rem;"></i>
                                    <p class="mt-3">Click "Load Records" ƒë·ªÉ b·∫Øt ƒë·∫ßu</p>
                                </div>
                            </div>
                        </div>
                        <!-- Pagination -->
                        <div class="card-footer bg-light" id="reviewPaginationSection" style="display: none;">
                            <div class="d-flex justify-content-between align-items-center">
                                <button class="btn btn-sm btn-outline-secondary" id="reviewPrevBtn" disabled>
                                    <i class="bi bi-chevron-left"></i> Previous
                                </button>
                                <span class="text-muted small" id="reviewPaginationInfo">0 - 0 of 0</span>
                                <button class="btn btn-sm btn-outline-secondary" id="reviewNextBtn" disabled>
                                    Next <i class="bi bi-chevron-right"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Right Column: Session Statistics Sidebar -->
            <div class="col-lg-2">
                <div class="sticky-top" style="top: 20px;">
                    <div class="card shadow-sm" id="sessionStatsCard">
                        <div class="card-header bg-info text-white">
                            <h6 class="mb-0">
                                <i class="bi bi-bar-chart-fill"></i> Session Stats
                            </h6>
                        </div>
                        <div class="card-body" id="sessionStatsBody">
                            <!-- Session stats will be displayed here -->
                            <div class="text-center text-muted py-4">
                                <i class="bi bi-hourglass-split" style="font-size: 2rem;"></i>
                                <p class="small mb-0 mt-2">Ch∆∞a c√≥ session</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </div>

    <!-- Footer -->
    <footer class="bg-light text-center text-muted py-4 mt-5">
        <div class="container">
            <p class="mb-0">
                <i class="bi bi-code-slash"></i>
                BIDV - D&A - Hieulm8 |
                <a href="/stats" class="text-decoration-none">View Statistics</a>
            </p>
        </div>
    </footer>

    <!-- Bootstrap 5 JS Bundle -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

    <!-- Custom JS -->
    <script src="{{ url_for('static', filename='js/script.js') }}"></script>
</body>
</html>
